(this["webpackJsonptracie-dashboard"]=this["webpackJsonptracie-dashboard"]||[]).push([[0],{140:function(e,t,a){},174:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(9),s=a.n(c),i=(a(140),a(122)),o=a(13),l=a(55),u=a(124),d=a(38),h=a(93),b=a.n(h),j=a(114),v=a(47),p=a(48),f=a(65),m=a(76),O=a(75),x=a(36),y=a.n(x),g=a(115),k=a.n(g),S=a(203),w=a(176),D=a(58),C=a(123),_=a(4),E=function(e){Object(m.a)(a,e);var t=Object(O.a)(a);function a(){var e;Object(v.a)(this,a);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).canvas=void 0,e.chart=void 0,e.setData=function(){e.chart&&(e.chart.destroy(),e.chart=void 0),e.canvas&&e.props.data&&(e.chart=new k.a(e.canvas,M(e.props.data)))},e}return Object(p.a)(a,[{key:"componentDidMount",value:function(){this.setData()}},{key:"componentDidUpdate",value:function(){this.setData()}},{key:"render",value:function(){var e=this,t=this.props.data,a=Math.min(1200,window.innerWidth-140),n=Math.min(400,window.innerHeight-260);return t?Object(_.jsx)(w.a,{style:N.graph,children:Object(_.jsx)("div",{children:Object(_.jsx)("canvas",{height:n,width:a,ref:function(t){return e.canvas=t}})})}):Object(_.jsxs)(w.a,{component:"div",className:y.a.emptyBox,children:[Object(_.jsx)(S.a,{style:{fontSize:82}}),Object(_.jsx)(D.a,{variant:"h6",children:"No events selected"}),Object(_.jsx)(D.a,{variant:"body2",children:"Enter an event name to display graph"})]})}}]),a}(r.a.Component),T=Object(C.a)(),N={graph:{padding:T.spacing(1),paddingTop:T.spacing(4),marginTop:T.spacing(2)}},I=["#ec407a","#36a2eb","#66bb6a","#4bc0c0","#303f9f","#ef5350","#ab47bc","#7e57c2","#42a5f5","#ffa726","#333538"];function M(e){var t;return{type:"line",data:{labels:function(e){return e.length?e[0].data.map((function(e){return new Date(e.x)})):[]}(e),datasets:(t=e,t.map((function(e,t){return{label:e.name,borderColor:I[t],backgroundColor:I[t],data:e.data.map((function(e){return e.y})),pointRadius:0,fill:!1,lineTension:.1}})))},options:{animation:{duration:0},responsive:!0,scales:{xAxes:[{type:"time",distribution:"series",display:!0,scaleLabel:{display:!0},ticks:{maxRotation:0,maxTicksLimit:8}}],yAxes:[{display:!0,ticks:{maxTicksLimit:8},scaleLabel:{display:!0}}]},tooltips:{intersect:!1,mode:"index"}}}}var P=function(){function e(t){Object(v.a)(this,e),this._endpoint=void 0,this._endpoint=t.server}return Object(p.a)(e,[{key:"query",value:function(e,t){return this.request("GET","",{transformResult:function(e){return e.data},query:Object(l.a)(Object(l.a)({},t),{},{$name:e.join(",")})})}},{key:"request",value:function(e,t,a){var n=this;return new Promise((function(r,c){var s="".concat(n._endpoint,"/").concat(t),i={method:e},o=Object.assign({},a),l=o.data,u=o.query,h=o.transformResult;l&&(i=Object.assign(i,{body:JSON.stringify(l),headers:Object(d.a)({},"Content-Type","application/json")})),u&&(s=function(e,t){var a=Object.keys(t).map((function(e){return t[e]?"".concat(e,"=").concat(t[e]):null})).filter((function(e){return e})).join("&");if(-1!==(e.split("/").pop()||"").indexOf("?"))return"".concat(e,"&").concat(a);return"".concat(e,"?").concat(a)}(s,u)),fetch(s,i).then((function(e){return e.json()})).then((function(e){return r(h?h(e):e)})).catch(c)}))}}]),e}(),L=window.location.host||"localhost:8080",V=window.TC_ENDPOINT||"/tc",A=new P({server:"//".concat(L).concat(V)}),B=a(120),R=a.n(B),F=a(97),J=a(206),H=a(211),G=a(212),$=a(214),q="tracie_presets";function W(e){localStorage.setItem(q,JSON.stringify(e))}function U(){var e=localStorage.getItem(q)||"[]";return JSON.parse(e)}var z={save:function(e,t){var a=U();t||(t="".concat(e.keyword," \u2014 ").concat(e.period,", ").concat(e.intervalValue||"every"," ").concat(e.interval," ").concat(e.valueIncreasing?", value increase":"")),a.push({id:a.length,name:t,state:e}),W(a)},list:U,remove:function(e){var t=U();t.splice(e,1),W(t)}},K=a(205),Z=a(223),Q=a(207),X=a(180),Y=a(208),ee=a(209),te=a(210),ae=a(213);function ne(e){var t=r.a.useState(null),a=Object(F.a)(t,2),n=a[0],c=a[1],s=function(){c(null)},i=z.list();return Object(_.jsxs)(_.Fragment,{children:[Object(_.jsx)(K.a,{"aria-controls":"simple-menu","aria-haspopup":"true",onClick:function(e){c(e.currentTarget)},children:Object(_.jsx)(J.a,{})}),Object(_.jsx)(Z.a,{open:Boolean(n),anchorEl:n,onClose:s,elevation:2,anchorOrigin:{vertical:"bottom",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"},children:Object(_.jsxs)(Q.a,{children:[i.length?i.map((function(t){return Object(_.jsx)(re,{handleClose:s,handleSelect:e.handleSelect,item:t},"query-preset-".concat(t.id))})):Object(_.jsx)(X.a,{children:Object(_.jsx)(Y.a,{primary:"No presets"})}),Object(_.jsx)(ee.a,{}),Object(_.jsxs)(X.a,{button:!0,onClick:function(){e.handleSave&&e.handleSave(),s()},children:[Object(_.jsx)(te.a,{children:Object(_.jsx)(H.a,{})}),Object(_.jsx)(Y.a,{primary:"Save preset"})]}),e.handleClear&&Object(_.jsxs)(X.a,{button:!0,onClick:e.handleClear,children:[Object(_.jsx)(te.a,{children:Object(_.jsx)(G.a,{})}),Object(_.jsx)(Y.a,{primary:"Clear data"})]})]})})]})}function re(e){var t=e.item;var a=t.name.split("\u2014"),n=Object(F.a)(a,2),r=n[0],c=n[1];return Object(_.jsxs)(X.a,{button:!0,onClick:function(){e.handleClose(),e.handleSelect&&e.handleSelect(t)},children:[Object(_.jsx)(Y.a,{primary:r,secondary:c}),Object(_.jsx)(ae.a,{children:Object(_.jsx)(K.a,{onClick:function(){z.remove(t.id),e.handleClose()},children:Object(_.jsx)($.a,{})})})]})}var ce=a(74),se=a(219),ie=a(89),oe=a(92),le=a(182),ue=a(216),de=a(217),he=a(218),be=a(224),je=a(121);function ve(e){return e.map((function(e){return{name:e.name,data:Object.keys(e.result).map((function(t,a){return{x:new Date(t),y:e.result[t]}}))}}))}function pe(e){var t=Object(je.cloneDeep)(e),a=0;return t.forEach((function(e){a=0,e.data.forEach((function(e){e.y=a+=e.y}))})),t}function fe(e){var t=new Date(e.date),a=e.intervalValue,n=void 0===a?1:a;switch(e.interval){case"day":t.setDate(t.getDate()+n);break;case"hour":t.setHours(t.getHours()+n);break;case"minute":t.setMinutes(t.getMinutes()+n);break;case"month":t.setMonth(t.getMonth()+n);break;case"week":t.setDate(t.getDate()+7*n)}return t}var me=["January","February","March","April","May","June","July","August","September","October","November","December"],Oe=["#4dc9f6","#f67019","#f53794","#537bc4","#acc236","#166a8f","#00a950","#58595b","#8549ba"],xe={};xe.utils={srand:function(e){this._seed=e},rand:function(e,t){var a=this._seed;return e=void 0===e?0:e,t=void 0===t?1:t,this._seed=(9301*a+49297)%233280,e+this._seed/233280*(t-e)},numbers:function(e){var t,a,n=e||{},r=n.min||0,c=n.max||1,s=n.from||[],i=n.count||8,o=n.decimals||8,l=n.continuity||1,u=Math.pow(10,o)||0,d=[];for(t=0;t<i;++t)a=(s[t]||0)+this.rand(r,c),this.rand()<=l?d.push(Math.round(u*a)/u):d.push(null);return d},labels:function(e){var t,a=e||{},n=a.min||0,r=a.max||100,c=(r-n)/(a.count||8),s=a.decimals||8,i=Math.pow(10,s)||0,o=a.prefix||"",l=[];for(t=n;t<r;t+=c)l.push(o+Math.round(i*t)/i);return l},months:function(e){var t,a,n=e||{},r=n.count||12,c=n.section,s=[];for(t=0;t<r;++t)a=me[Math.ceil(t)%12],s.push(a.substring(0,c));return s},color:function(e){return Oe[e%Oe.length]},transparentize:function(e,t){var a=void 0===t?.5:1-t;return Color[e].alpha(a).rgbString()}},xe.utils.srand(Date.now());function ye(e,t){var a=function(e){var t=e.start,a=e.end,n=e.interval,r=e.intervalValue;switch(n){case"month":case"week":case"day":t.setHours(0,0,0,0),a.setHours(0,0,0,0);break;case"hour":t.setMinutes(0,0,0),a.setMinutes(0,0,0);break;case"minute":t.setSeconds(0,0),a.setSeconds(0,0)}for(var c=new Date(t),s=[],i=new Date(t),o=a.getTime()+1;i.getTime()<o;)i=fe({date:i,interval:n,intervalValue:r}),s.push({start:c,end:i}),c=i;return s}(t),n={};return a.forEach((function(e){n[e.start.toJSON()]=Math.round(xe.utils.rand(100,5e3))})),{name:e,result:n}}function ge(e,t){return e.map((function(e){return ye(e,{interval:t.$interval,start:new Date(t.$start),end:new Date(t.$end),intervalValue:t.$intervalValue})}))}var ke=function(e){Object(m.a)(a,e);var t=Object(O.a)(a);function a(){var e;Object(v.a)(this,a);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).state={interval:"day",period:"30",valueIncreasing:!1},e.data=void 0,e.handleSubmit=function(t){t.preventDefault(),e.fetchData()},e.clearData=function(){e.data=void 0,e.setState({data:void 0})},e.fetchData=Object(j.a)(b.a.mark((function t(){var a,n,r,c,s,i;return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.state.keyword){t.next=34;break}a=e.state.start,n=e.state.end,t.t0=e.state.period,t.next="custom"===t.t0?5:"all"===t.t0?6:9;break;case 5:return t.abrupt("break",13);case 6:return a=void 0,n=void 0,t.abrupt("break",13);case 9:a=new Date,n=(new Date).toJSON(),a.setDate(a.getDate()-parseInt(e.state.period)),a=a.toJSON();case 13:if(t.prev=13,r=e.state.keyword,c={$interval:e.state.interval,$start:a,$end:n,$intervalValue:e.state.intervalValue},"true"!==Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}).REACT_APP_USE_SAMPLE_DATA){t.next=20;break}t.t1=ge(r,c),t.next=23;break;case 20:return t.next=22,A.query(r,c);case 22:t.t1=t.sent;case 23:s=t.t1,e.data=ve(s),e.setGraphData(),t.next=34;break;case 28:t.prev=28,t.t2=t.catch(13),console.log(t.t2),(i=t.t2.toString()).indexOf("Failed to fetch")&&(i="Unable to reach server"),e.props.enqueueSnackbar(i,{variant:"error"});case 34:case"end":return t.stop()}}),t,null,[[13,28]])}))),e.setGraphData=function(){if(Object(f.a)(e)&&e.data){var t=e.state.valueIncreasing?pe(e.data):e.data;e.setState({data:t})}},e.handleChange=function(t){var a=t.target;a.value!==e.state[a.name]&&e.setState(Object(d.a)({},a.name,"checkbox"===a.type?a.checked:a.value),(function(){"valueIncreasing"===a.name?e.setGraphData():e.fetchData()}))},e.handleValueChange=function(t){var a=t.target;a.value!==e.state[a.name]&&e.setState(Object(d.a)({},a.name,"checkbox"===a.type?a.checked:a.value))},e.savePreset=function(){var t=e.state,a=(t.data,Object(u.a)(t,["data"]));z.save(a)},e.setPreset=function(t){e.setState(Object(l.a)({},t.state),(function(){e.fetchData()}))},e}return Object(p.a)(a,[{key:"render",value:function(){var e=this,t=this.state,a=t.interval,n=t.period,r=t.intervalValue;return Object(_.jsxs)(_.Fragment,{children:[Object(_.jsxs)("div",{className:y.a.bar,children:[Object(_.jsxs)("div",{className:y.a.barGroup,children:[Object(_.jsxs)(ie.a,{children:[Object(_.jsx)(oe.a,{id:"period-label",children:"Period"}),Object(_.jsxs)(le.a,{labelId:"period-label",name:"period",value:n,onChange:this.handleChange,children:[Object(_.jsx)(ue.a,{value:"all",children:"All time"}),Object(_.jsx)(ue.a,{value:"7",children:"Last 7 days"}),Object(_.jsx)(ue.a,{value:"30",children:"Last 30 days"}),Object(_.jsx)(ue.a,{value:"90",children:"Last 90 days"}),Object(_.jsx)(ue.a,{value:"180",children:"Last 180 days"}),Object(_.jsx)(ue.a,{value:"custom",children:"Custom"})]})]}),"custom"===n&&Object(_.jsxs)(_.Fragment,{children:[Object(_.jsx)(ee.a,{orientation:"vertical"}),Object(_.jsx)(de.a,{name:"start",label:"Start Date",type:"minute"===a?"datetime-local":"date",onBlur:this.handleChange,InputLabelProps:{shrink:!0}}),Object(_.jsx)(de.a,{name:"end",label:"End Date",type:"minute"===a?"datetime-local":"date",onBlur:this.handleChange,InputLabelProps:{shrink:!0}})]}),Object(_.jsx)(ee.a,{orientation:"vertical"}),Object(_.jsxs)(ie.a,{children:[Object(_.jsx)(oe.a,{id:"interval-label",children:"Interval"}),Object(_.jsxs)(le.a,{labelId:"interval-label",id:"demo-simple-select",name:"interval",value:a,onChange:this.handleChange,children:[Object(_.jsxs)(ue.a,{value:"month",children:["Every ",r," Month"]}),Object(_.jsxs)(ue.a,{value:"week",children:["Every ",r," Week"]}),Object(_.jsxs)(ue.a,{value:"day",children:["Every ",r," Day"]}),Object(_.jsxs)(ue.a,{value:"hour",children:["Every ",r," Hour"]}),Object(_.jsxs)(ue.a,{value:"minute",children:["Every ",r," Minute"]})]})]}),Object(_.jsx)(de.a,{name:"intervalValue",defaultValue:"1",type:"number",onChange:this.handleChange,label:"Interval value"}),Object(_.jsx)(ee.a,{orientation:"vertical"}),Object(_.jsx)(he.a,{control:Object(_.jsx)(be.a,{checked:this.state.valueIncreasing,name:"valueIncreasing",color:"primary",onChange:this.handleChange,inputProps:{"aria-label":"Switch show value increasing"}}),label:"Show value increasing"})]}),Object(_.jsxs)("div",{className:y.a.flexRow,children:[Object(_.jsxs)("form",{onSubmit:this.handleSubmit,className:y.a.form,children:[Object(_.jsx)(R.a,{placeholder:"Enter event name",defaultValue:this.state.keyword,onChange:function(t){return e.handleValueChange({target:{value:t,name:"keyword"}})}}),Object(_.jsx)(K.a,{type:"submit",className:y.a.iconButton,"aria-label":"search",children:Object(_.jsx)(se.a,{})})]}),Object(_.jsx)(ne,{handleClear:this.clearData,handleSave:this.savePreset,handleSelect:this.setPreset})]})]}),Object(_.jsx)(E,{data:this.state.data})]})}}]),a}(r.a.Component),Se=Object(ce.b)(ke),we=a(215),De=a(220),Ce=a(221),_e=a(222);var Ee=Object(we.a)((function(e){return{root:{flexGrow:1},body:{marginTop:e.spacing(4)},menuButton:{marginRight:e.spacing(2)},title:{flexGrow:1}}})),Te=function(){var e=Ee();return Object(_.jsx)(ce.a,{children:Object(_.jsx)("div",{className:e.root,children:Object(_.jsxs)(i.a,{children:[Object(_.jsx)(De.a,{color:"primary",position:"static",children:Object(_.jsx)(Ce.a,{component:_e.a,maxWidth:"lg",children:Object(_.jsx)(D.a,{variant:"h6",className:e.title,children:"Tracie Dashboard"})})}),Object(_.jsx)(Ce.a,{className:e.body,maxWidth:"lg",children:Object(_.jsx)(o.c,{children:Object(_.jsx)(o.a,{path:"/",component:Se})})})]})})})},Ne=function(e){e&&e instanceof Function&&a.e(3).then(a.bind(null,226)).then((function(t){var a=t.getCLS,n=t.getFID,r=t.getFCP,c=t.getLCP,s=t.getTTFB;a(e),n(e),r(e),c(e),s(e)}))};s.a.render(Object(_.jsx)(Te,{}),document.getElementById("root")),Ne()},36:function(e,t,a){e.exports={emptyBox:"styles_emptyBox__2I2Sk",flexRow:"styles_flexRow__zI-uc",iconButton:"styles_iconButton__2jaUf",form:"styles_form__5h7V1",barGroup:"styles_barGroup__1L-e8",bar:"styles_bar__1ZHgN"}}},[[174,1,2]]]);
//# sourceMappingURL=main.164cc8e0.chunk.js.map